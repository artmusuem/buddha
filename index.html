<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Van Gogh Museum</title> <!-- *********** Changed from Oakwood Museum to Van Gogh Museum -->
  <link rel="stylesheet" href="/artist-museum/css/style.css" /> <!-- *********** Changed from /site-root-folder/ to /artist-museum/ -->
  <script defer src="/artist-museum/js/bundle.js"></script> <!-- *********** Changed from /site-root-folder/ to /artist-museum/ -->
<style>
.car-sidebar {
  position: fixed;
  top: 0;
  left: 0;
  width: 220px;
  height: 100vh;
  background-color: #f8f9fa;
  border-right: 1px solid #ccc;
  box-shadow: 2px 0 4px rgba(0, 0, 0, 0.05);
  z-index: 1000;
  transform: translateX(-100%);
  transition: transform 0.3s ease;
  display: flex;
  flex-direction: column;
}

.car-sidebar.open {
  transform: translateX(0);
}

/* Fixed header area - doesn't scroll */
.car-sidebar-header {
  flex-shrink: 0;
  padding: 6em 1em 1em 1em;
  background-color: #f8f9fa;
  border-bottom: 1px solid #e0e0e0;
}

/* Scrollable content area */
.car-sidebar-content {
  flex: 1;
  overflow-y: scroll;
  overflow-x: hidden;
  padding: 1em;
}

#close-sidebar {
  position: absolute;
  top: 0.5em;
  right: 0.5em;
  background: none;
  border: none;
  font-size: 1.5em;
  cursor: pointer;
  color: #333;
}

.car-sidebar h2 {
  font-size: 1.2em;
  margin-bottom: 1em;
  color: #333;
}

.car-sidebar ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.car-sidebar ul li {
  margin-bottom: 0.5em;
}

.car-sidebar ul li a {
  text-decoration: none;
  color: #0074cc;
  font-weight: bold;
  cursor: pointer;
}

.car-sidebar details summary {
  cursor: pointer;
}

.car-sidebar details ul li a {
  cursor: pointer;
}

/* Scrollbar styling for content area */
.car-sidebar-content::-webkit-scrollbar {
  width: 8px;
}

.car-sidebar-content::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 4px;
}

.car-sidebar-content::-webkit-scrollbar-thumb {
  background: #c1c1c1;
  border-radius: 4px;
}

.car-sidebar-content::-webkit-scrollbar-thumb:hover {
  background: #a1a1a1;
}

#menu-toggle {
  position: fixed;
  top: 1em;
  left: 1em;
  z-index: 1100;
  background: none;
  border: none;
  font-size: 1.8em;
  cursor: pointer;
}

.search-bar {
  display: table;
  margin: 0 auto;
}

.statue-nav {
  display: table;
  margin: 0 auto;
}

.filter-buttons {
  display: flex;
  justify-content: center;
  gap: 1em;
  flex-wrap: wrap;
  margin: 1em 0;
}

.filter-buttons button {
  background-color: #f0f0f0;
  border: 1px solid #ccc;
  border-radius: 4px;
  padding: 0.5em 1em;
  cursor: pointer;
  font-size: 1em;
  color: #333;
}

.filter-buttons button:hover {
  background-color: #e0e0e0;
}

#clear-filters {
  margin-top: 0.5em;
  display: none;
  text-align: center;
}

#clear-filters button {
  background-color: #fff4f4;
  border: 1px solid #cc0000;
  color: #cc0000;
  padding: 0.4em 1em;
  border-radius: 4px;
  cursor: pointer;
}

#clear-filters button:hover {
  background-color: #ffe5e5;
}

.gallery {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  padding: 1em;
}

.gallery-item {
  display: inline-block;
  margin: 10px;
  text-align: center;
}

.gallery-item img {
  max-width: 200px;
  height: auto;
}
</style>
</head>
<body>
  <div id="menu-placeholder"></div>

  <button id="menu-toggle">‚ò∞</button>

 <div class="car-sidebar" id="sidebar">
  <!-- Fixed header area -->
  <div class="car-sidebar-header">
    <button id="close-sidebar" aria-label="Close sidebar">‚úï</button>
    <h2>Filter Menu</h2>
    <button onclick="filterGallery('')">Clear Filter</button>
  </div>
  
  <!-- Scrollable content area -->
  <div class="car-sidebar-content">
    <ul id="dynamic-menu"></ul>
  </div>
</div>

  <header>
    <h1>Van Gogh Museum</h1> <!-- *********** Changed from Oakwood Museum to Van Gogh Museum -->
    <h2 id="gallery-title">All Art</h2>
    <div class="search-bar">
      <input type="text" id="searchBox" placeholder="Search artworks..." /> <!-- *********** Changed from Search items to Search artworks -->
      <button id="searchButton">üîç</button>
      <div id="searchResults" style="margin-top: 0.5em;"></div>
    </div>
  </header>

  <nav class="statue-nav">
    <div class="filter-buttons">
      <!-- ===================================================== -->
      <!-- CHANGE 5: UPDATE filter buttons for Van Gogh content -->
      <!-- LOCATION: Around line 120 in index.html filter-buttons section -->
      <!-- ACTION: REPLACE with new filter buttons -->
      <!-- ===================================================== -->
      <button onclick="filterGallery('time_19th')">19th Century</button>
      <button onclick="filterGallery('feeling_dynamic')">Dynamic</button>
      <button onclick="filterGallery('Post-Impressionism')">Post-Impressionist</button>
      <button onclick="filterGallery('material_oil')">Oil Paintings</button>
    </div>
    <div id="clear-filters">
      <button onclick="filterGallery('')">Clear Filters</button>
    </div>
  </nav>

  <main>
    <div id="gallery" class="gallery"></div>
  </main>

  <footer>
    <p>¬© 2025 Van Gogh Museum. All Rights Reserved.</p> <!-- *********** Changed from Oakwood Museum to Van Gogh Museum -->
  </footer>

<script>
  // Add this utility function at the top of your script
  function fetchFilteredData(url) {
    return fetch(url)
      .then(res => res.json())
      .then(data => {
        // Filter out items with status "hide" at the data level
        return data.filter(item => item.status !== 'hide');
      });
  }

  // Helper function to check if a field should be shown
  function shouldShowField(value) {
    return value && value !== 'hide';
  }

  document.addEventListener("DOMContentLoaded", () => {
    const sidebar = document.getElementById("sidebar");
    const toggleButton = document.getElementById("menu-toggle");
    const closeBtn = document.getElementById("close-sidebar");
    const gallery = document.getElementById("gallery");
    const menu = document.getElementById("dynamic-menu");
    const title = document.getElementById("gallery-title");
    const clearBtnContainer = document.getElementById("clear-filters");

    // =====================================================
    // CHANGE 3: ADD art_movement to labelMap
    // LOCATION: Around line 90 in index.html JavaScript section
    // ACTION: ADD new label mapping
    // =====================================================
    const labelMap = {
      // Time periods - clean labels
      "time_ancient": "Ancient Period",
      "time_modern": "Modern Era", 
      "time_past": "Historical Period",
      "time_19th": "19th Century", // Added for Van Gogh content
      
      // Feelings - clean labels
      "feeling_melancholy": "Melancholy",
      "feeling_peaceful": "Peaceful",
      "feeling_dynamic": "Dynamic", // Added for Van Gogh content
      "feeling_joyful": "Joyful", // Added for Van Gogh content
      "feeling_contemplative": "Contemplative", // Added for Van Gogh content
      
      // Materials - clean labels
      "material_bronze": "Bronze",
      "material_cloth": "Cloth",
      "material_marble": "Marble", 
      "material_silk": "Silk",
      "material_terracotta": "Terracotta",
      "material_wood": "Wood",
      "material_oil": "Oil", // Added for Van Gogh content
      
      // Context - descriptive labels
      "ceremonial_buddha": "Ceremonial Buddha",
      "cosmic_buddha": "Cosmic Buddha",
      "devotional_scroll": "Devotional Scroll",
      "dibo": "Dibo Style",
      "luohan": "Luohan (Arhat)",
      "meditative_buddha": "Meditative Buddha", 
      "ming_buddha": "Ming Dynasty Buddha",
      "narrative_thangka": "Narrative Thangka",
      "vangogh_saintRemy": "Saint-R√©my Period", // Added for Van Gogh content
      "vangogh_arles": "Arles Period", // Added for Van Gogh content
      
      // Gallery categories (keep existing)
      "statue": "Statues Gallery",
      "sculpture": "Sculptures Gallery", 
      "painting": "Paintings Gallery",
      "thangka": "Thangkas Gallery",
      "landscape": "Landscapes", // Added for Van Gogh content
      "stilllife": "Still Life", // Added for Van Gogh content
      "interior": "Interiors", // Added for Van Gogh content
      "botanical": "Botanical", // Added for Van Gogh content
      
      // Art Movement - new category for artist museum
      "Post-Impressionism": "Post-Impressionist Works"  // ADD: Human-readable label for Post-Impressionism filter
    };

    toggleButton.addEventListener("click", () => sidebar.classList.toggle("open"));
    closeBtn.addEventListener("click", () => sidebar.classList.remove("open"));

    document.addEventListener("click", (e) => {
      if (!sidebar.contains(e.target) && !toggleButton.contains(e.target)) {
        sidebar.classList.remove("open");
      }
    });

    document.addEventListener("touchstart", (e) => {
      if (!sidebar.contains(e.target) && !toggleButton.contains(e.target)) {
        sidebar.classList.remove("open");
      }
    });

    fetchFilteredData("/artist-museum/data/c-1.json") // *********** Changed from /site-root-folder/ to /artist-museum/
      .then(data => {
        // =====================================================
        // CHANGE 1: ADD art_movement to categories object
        // LOCATION: Around line 170 in index.html JavaScript section
        // ACTION: ADD new category
        // =====================================================
        const categories = {
          time: new Set(),
          feeling: new Set(),
          material: new Set(),
          context: new Set(),
          art_movement: new Set()  // ADD: New category for art movement filtering
        };

        // =====================================================
        // CHANGE 2: ADD art_movement to data collection loop
        // LOCATION: Around line 180 in index.html JavaScript section  
        // ACTION: ADD new field collection
        // =====================================================
        data.forEach(item => {
          // Only add to categories if the field value isn't "hide"
          if (shouldShowField(item.time)) categories.time.add(item.time);
          if (shouldShowField(item.feeling)) categories.feeling.add(item.feeling);
          if (shouldShowField(item.material)) categories.material.add(item.material);
          if (shouldShowField(item.context)) categories.context.add(item.context);
          if (shouldShowField(item.art_movement)) categories.art_movement.add(item.art_movement);  // ADD: Collect art_movement values
        });

        for (const [type, values] of Object.entries(categories)) {
          const group = document.createElement("li");
          const label = type.charAt(0).toUpperCase() + type.slice(1);
          group.innerHTML = `
            <details>
              <summary>${label}</summary>
              <ul>
                ${[...values].sort().map(v => {
                  // Use clean label from labelMap, or fallback to original value
                  const displayLabel = labelMap[v] || v.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                  return `<li><a href="#" onclick="filterGallery('${v}'); return false;">${displayLabel}</a></li>`;
                }).join('')}
              </ul>
            </details>
          `;
          menu.appendChild(group);
        }

        window.fullData = data;
        loadGallery(data);
      });

    window.filterGallery = function (category) {
      if (!category) {
        title.textContent = "All Art";
        clearBtnContainer.style.display = "none";
        loadGallery(window.fullData);
        return;
      }

      title.textContent = labelMap[category] || `Filtered by: ${category}`;
      clearBtnContainer.style.display = "block";

      // =====================================================
      // CHANGE 4: ADD art_movement to filterGallery function
      // LOCATION: Around line 220 in index.html JavaScript section
      // ACTION: ADD new field to filtering logic
      // =====================================================
      const filtered = window.fullData.filter(item =>
        item.category === category ||
        item.style === category ||
        item.context === category ||
        item.feeling === category ||
        item.time === category ||
        item.material === category ||
        item.art_movement === category  // ADD: Include art_movement in filter logic
      );
      loadGallery(filtered);
    };

    function loadGallery(items) {
      gallery.innerHTML = '';
      if (!items.length) {
        gallery.innerHTML = "<p>No results found.</p>";
        return;
      }

      items.forEach(item => {
        const div = document.createElement("div");
        div.className = "gallery-item";
        
        // Universal field handling - only show if field exists and isn't "hide"
        const titleHTML = shouldShowField(item.title) ? `<h3>${item.title}</h3>` : '';
        
        // Use template-page field or default to dt-1.html
        const templatePage = item['template-page'] || 'dt-1.html';

        div.innerHTML = `
          <a href="/artist-museum/page-templates/${templatePage}?sku=${item.sku}"> <!-- *********** Changed from /site-root-folder/ to /artist-museum/ -->
            <img src="${item.image}" alt="${shouldShowField(item.title) ? item.title : ''}">
            ${titleHTML}
          </a>
        `;
        gallery.appendChild(div);
      });
    }
  });
</script>
</body>
</html>