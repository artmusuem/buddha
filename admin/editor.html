<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Buddha Collection Admin</title>
  <script>
    // Environment detection and path setup
    (function() {
      const isGitHub = window.location.hostname.includes('github.io');
      const basePath = isGitHub ? '/buddha' : '';
      
      // Store for use throughout the page
      window.SITE_BASE_PATH = basePath;
      window.IS_GITHUB = isGitHub;
      
      if (isGitHub) {
        // Show Gateway page for GitHub Pages users
        document.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <title>Admin Gateway - Buddha Museum</title>
            <style>
              * { box-sizing: border-box; }
              body { 
                font-family: 'Georgia', 'Times New Roman', serif; 
                text-align: center; 
                padding: 20px; 
                background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
                min-height: 100vh;
                margin: 0;
                color: white;
              }
              .container { 
                max-width: 700px; 
                margin: 0 auto; 
                background: white; 
                color: #333;
                padding: 30px; 
                border-radius: 12px; 
                box-shadow: 0 8px 30px rgba(0,0,0,0.3); 
              }
              h1 { 
                color: #8B4513; 
                margin-bottom: 30px; 
                font-size: 2rem;
                font-weight: 300;
              }
              p { margin: 20px 0; line-height: 1.7; font-size: 1rem; }
              .gateway-link { 
                display: inline-block; 
                background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
                color: white; 
                padding: 15px 30px; 
                text-decoration: none; 
                border-radius: 8px; 
                margin: 20px 0; 
                font-weight: bold; 
                font-size: 1.1rem;
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                transition: all 0.3s ease;
              }
              .gateway-link:hover { 
                transform: translateY(-2px); 
                box-shadow: 0 6px 20px rgba(0,0,0,0.3);
              }
              .gallery-link { 
                display: inline-block; 
                background: #666; 
                color: white; 
                padding: 10px 20px; 
                text-decoration: none; 
                border-radius: 6px; 
                margin: 10px; 
                transition: background 0.3s;
                font-size: 0.9rem;
              }
              .gallery-link:hover { background: #555; }
              .features {
                background: #f8f9fa;
                padding: 20px;
                border-radius: 8px;
                margin: 20px 0;
                text-align: left;
              }
              .features h3 {
                color: #8B4513;
                margin-top: 0;
                font-size: 1.2rem;
              }
              .features ul {
                margin: 0;
                padding-left: 20px;
              }
              .features li {
                margin: 6px 0;
                font-size: 0.95rem;
              }
              .platform-badge {
                background: #e3f2fd;
                color: #1976d2;
                padding: 6px 12px;
                border-radius: 20px;
                font-size: 0.8rem;
                font-weight: bold;
                display: inline-block;
                margin: 10px 0;
              }
              
              @media (max-width: 768px) {
                .container { 
                  padding: 20px; 
                  margin: 10px;
                }
                h1 { font-size: 1.6rem; }
                p { font-size: 0.95rem; }
                .gateway-link { 
                  padding: 12px 25px; 
                  font-size: 1rem;
                }
                .features { padding: 15px; }
                .features h3 { font-size: 1.1rem; }
                .features li { font-size: 0.9rem; }
              }
            </style>
          </head>
          <body>
            <div class="container">
              <h1>üåê Netlify Editor Gateway</h1>
              <div class="platform-badge">üìç Currently on: GitHub Pages</div>
              
              <p><strong>Welcome to the Buddha Museum Admin Gateway!</strong></p>
              <p>You're viewing the <strong>GitHub Pages</strong> version of the site. For full admin functionality including live GitHub editing, please use our Netlify admin portal.</p>
              
              <div class="features">
                <h3>üõ† Available Admin Features on Netlify:</h3>
                <ul>
                  <li>‚úÖ <strong>Live GitHub Editing</strong> - Save directly to repository</li>
                  <li>‚úÖ <strong>Real-time Updates</strong> - Changes appear instantly</li>
                  <li>‚úÖ <strong>Local Backup</strong> - Download and restore data</li>
                  <li>‚úÖ <strong>Full JSON Management</strong> - Complete collection control</li>
                  <li>‚úÖ <strong>Secure API Access</strong> - Server-side GitHub integration</li>
                </ul>
              </div>
              
              <a href="https://museumart.netlify.app/admin/editor.html" class="gateway-link">
                üöÄ Launch Netlify Admin Portal
              </a>
              
              <p><strong>Why use Netlify for admin?</strong><br>
              Our admin panel requires server-side functions to securely connect with GitHub's API. These functions are hosted on Netlify and enable direct repository editing.</p>
              
              <div style="margin-top: 30px; padding-top: 15px; border-top: 1px solid #eee;">
                <a href="${basePath}/" class="gallery-link">‚Üê Browse Gallery</a>
                <a href="https://museumart.netlify.app/" class="gallery-link">Netlify Site</a>
              </div>
            </div>
          </body>
          </html>
        `);
        return;
      }
    })();
  </script>
  <link rel="stylesheet" href="/css/style.css" id="main-css">
</head>
<body class="admin-page">
  <!-- This content only loads on Netlify -->
  <header class="admin-header">
    <div class="header-content">
      <h1>üõ† Buddha Collection Admin</h1>
      <div class="admin-nav">
        <a href="/" class="nav-link gallery-link">‚Üê Back to Gallery</a>
        <a href="https://artmusuem.github.io/buddha/" class="nav-link github-link" target="_blank">
          üìñ Live Edits on GitHub
        </a>
        <span class="platform-indicator">üìç Netlify Admin</span>
      </div>
    </div>
  </header>

  <main class="admin-main">
    <div id="statusMessage" class="status-message" style="display: none;"></div>
    
    <div class="admin-controls">
      <div class="form-section">
        <label for="skuSelector">Select Artifact:</label>
        <select id="skuSelector">
          <option value="">Loading...</option>
        </select>
      </div>

      <div class="button-group">
        <button id="saveButton" class="btn btn-local">üíæ Save Locally</button>
        <button id="githubSaveButton" class="btn btn-github">üåê Save to GitHub</button>
        <button id="downloadButton" class="btn btn-download">üì• Download JSON</button>
      </div>
    </div>

    <div class="admin-content">
      <div class="form-panel">
        <h3>Edit Artifact Details</h3>
        <form class="edit-form">
          <div class="form-group">
            <label for="title">Title:</label>
            <input type="text" id="title" data-json-path="title">
          </div>
          
          <div class="form-group">
            <label for="subtitle">Subtitle:</label>
            <input type="text" id="subtitle" data-json-path="subtitle">
          </div>
          
          <div class="form-group">
            <label for="sku">SKU:</label>
            <input type="text" id="sku" data-json-path="sku">
          </div>
          
          <div class="form-group">
            <label for="image">Image URL:</label>
            <input type="text" id="image" data-json-path="image">
          </div>
          
          <div class="form-group">
            <label for="medium">Medium:</label>
            <input type="text" id="medium" data-json-path="medium">
          </div>
          
          <div class="form-group">
            <label for="dimensions">Dimensions:</label>
            <input type="text" id="dimensions" data-json-path="dimensions">
          </div>
          
          <div class="form-group">
            <label for="estimate">Estimate:</label>
            <input type="text" id="estimate" data-json-path="estimate">
          </div>
          
          <div class="form-group">
            <label for="price_realized">Price Realized:</label>
            <input type="text" id="price_realized" data-json-path="price_realized">
          </div>
          
          <div class="form-group">
            <label for="provenance">Provenance:</label>
            <textarea id="provenance" data-json-path="provenance" rows="3"></textarea>
          </div>
          
          <div class="form-group">
            <label for="essay">Essay:</label>
            <textarea id="essay" data-json-path="essay" rows="6"></textarea>
          </div>
          
          <div class="form-group">
            <label for="lot_link">Auction Link:</label>
            <input type="text" id="lot_link" data-json-path="lot_link">
          </div>
          
          <div class="form-group">
            <label for="status">Status:</label>
            <select id="status" data-json-path="status">
              <option value="">Show (default)</option>
              <option value="hide">Hide</option>
            </select>
          </div>
        </form>
      </div>

      <div class="preview-panel">
        <h3>JSON Preview</h3>
        <pre id="jsonPreview">Select an artifact to edit...</pre>
      </div>
    </div>
  </main>

  <script src="/admin/editor.js" id="main-js"></script>

  <script>
    // Update paths when DOM is ready (for Netlify only)
    document.addEventListener("DOMContentLoaded", function() {
      const basePath = window.SITE_BASE_PATH || '';
      
      // Update CSS path
      const cssLink = document.getElementById('main-css');
      if (cssLink) {
        cssLink.href = `${basePath}/css/style.css`;
      }
      
      // Update JavaScript path
      const jsScript = document.getElementById('main-js');
      if (jsScript) {
        jsScript.src = `${basePath}/admin/editor.js`;
      }
      
      // Update gallery navigation link
      const galleryLink = document.querySelector('.gallery-link');
      if (galleryLink) {
        galleryLink.href = `${basePath}/`;
      }
      
      console.log('Admin paths updated for environment:', basePath || 'root');
    });
  </script>

  <style>
    /* Global box-sizing fix */
    *, *::before, *::after {
      box-sizing: border-box;
    }

    .admin-page {
      font-family: 'Arial', sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }

    .admin-header {
      background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
      color: white;
      padding: 1rem 0;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-content {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .header-content h1 {
      margin: 0;
      font-size: 1.5rem;
      font-weight: 600;
    }

    .admin-nav {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      flex-wrap: wrap;
    }

    .nav-link {
      color: white;
      text-decoration: none;
      padding: 0.5rem 0.75rem;
      border-radius: 4px;
      transition: background 0.3s;
      display: inline-block;
      font-size: 0.9rem;
      white-space: nowrap;
    }

    .nav-link:hover {
      background: rgba(255,255,255,0.2);
    }

    .github-link {
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.3);
    }

    .github-link:hover {
      background: rgba(255,255,255,0.2);
      border-color: rgba(255,255,255,0.5);
    }

    .platform-indicator {
      background: rgba(255,255,255,0.2);
      padding: 0.5rem 0.75rem;
      border-radius: 4px;
      font-size: 0.8rem;
      white-space: nowrap;
    }

    .admin-main {
      max-width: 1400px;
      margin: 0 auto;
      padding: 1rem;
      min-height: calc(100vh - 120px);
    }

    .status-message {
      padding: 1rem;
      border-radius: 6px;
      margin-bottom: 1rem;
      font-weight: 500;
    }

    .status-success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
    .status-error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    .status-info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }

    .admin-controls {
      background: white;
      padding: 1.5rem;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 1.5rem;
    }

    .form-section {
      margin-bottom: 1.5rem;
    }

    .form-section label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: #333;
      font-size: 0.95rem;
    }

    .form-section select {
      width: 100%;
      padding: 0.75rem;
      border: 2px solid #ddd;
      border-radius: 6px;
      font-size: 1rem;
      background: white;
      transition: border-color 0.3s;
    }

    .form-section select:focus {
      outline: none;
      border-color: #8B4513;
      box-shadow: 0 0 0 3px rgba(139, 69, 19, 0.1);
    }

    .button-group {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .btn {
      padding: 0.75rem 1.25rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.95rem;
      font-weight: 600;
      transition: all 0.3s;
      min-width: 140px;
      text-align: center;
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .btn-local {
      background: #28a745;
      color: white;
    }

    .btn-local:hover {
      background: #218838;
    }

    .btn-github {
      background: #8B4513;
      color: white;
    }

    .btn-github:hover {
      background: #A0522D;
    }

    .btn-download {
      background: #6c757d;
      color: white;
    }

    .btn-download:hover {
      background: #5a6268;
    }

    .admin-content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
      align-items: start;
    }

    .form-panel, .preview-panel {
      background: white;
      padding: 1.5rem;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      min-height: 400px;
    }

    .form-panel h3, .preview-panel h3 {
      margin: 0 0 1.5rem 0;
      color: #8B4513;
      border-bottom: 2px solid #e0e0e0;
      padding-bottom: 0.75rem;
      font-size: 1.2rem;
      font-weight: 600;
    }

    .edit-form {
      width: 100%;
    }

    .form-group {
      margin-bottom: 1.25rem;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: #333;
      font-size: 0.9rem;
    }

    .form-group input, 
    .form-group textarea, 
    .form-group select {
      width: 100%;
      padding: 0.75rem;
      border: 2px solid #ddd;
      border-radius: 6px;
      font-size: 0.95rem;
      font-family: inherit;
      transition: border-color 0.3s, box-shadow 0.3s;
      background: white;
    }

    .form-group input:focus, 
    .form-group textarea:focus, 
    .form-group select:focus {
      outline: none;
      border-color: #8B4513;
      box-shadow: 0 0 0 3px rgba(139, 69, 19, 0.1);
    }

    .form-group textarea {
      resize: vertical;
      min-height: 80px;
      line-height: 1.5;
    }

    #jsonPreview {
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 6px;
      padding: 1rem;
      overflow-x: auto;
      font-size: 0.85rem;
      line-height: 1.4;
      max-height: 600px;
      overflow-y: auto;
      font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
      white-space: pre-wrap;
      word-break: break-word;
    }

    /* Responsive Design */
    @media (max-width: 1200px) {
      .admin-main {
        padding: 1rem 0.75rem;
      }
      
      .admin-content {
        gap: 1rem;
      }
      
      .form-panel, .preview-panel {
        padding: 1.25rem;
      }
    }

    @media (max-width: 768px) {
      .header-content {
        flex-direction: column;
        text-align: center;
        padding: 0 0.75rem;
      }
      
      .header-content h1 {
        font-size: 1.3rem;
      }
      
      .admin-nav {
        justify-content: center;
        flex-wrap: wrap;
        gap: 0.5rem;
      }
      
      .nav-link, .platform-indicator {
        font-size: 0.8rem;
        padding: 0.4rem 0.6rem;
      }
      
      .admin-main {
        padding: 0.75rem 0.5rem;
      }
      
      .admin-controls {
        padding: 1rem;
        margin-bottom: 1rem;
      }
      
      .admin-content {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
      
      .form-panel, .preview-panel {
        padding: 1rem;
      }
      
      .button-group {
        flex-direction: column;
        gap: 0.75rem;
      }
      
      .btn {
        min-width: auto;
        padding: 0.65rem 1rem;
        font-size: 0.9rem;
      }
      
      .form-group input, 
      .form-group textarea, 
      .form-group select {
        padding: 0.65rem;
        font-size: 0.9rem;
      }
      
      #jsonPreview {
        font-size: 0.8rem;
        max-height: 400px;
      }
    }

    @media (max-width: 480px) {
      .admin-main {
        padding: 0.5rem 0.25rem;
      }
      
      .admin-controls {
        padding: 0.75rem;
      }
      
      .form-panel, .preview-panel {
        padding: 0.75rem;
      }
      
      .form-section select {
        padding: 0.6rem;
      }
      
      .btn {
        padding: 0.6rem 0.75rem;
        font-size: 0.85rem;
      }
      
      .form-group input, 
      .form-group textarea, 
      .form-group select {
        padding: 0.6rem;
        font-size: 0.85rem;
      }
      
      .form-group label {
        font-size: 0.85rem;
      }
    }

    /* Print styles */
    @media print {
      .admin-header, .button-group {
        display: none;
      }
      
      .admin-content {
        grid-template-columns: 1fr;
      }
      
      .preview-panel {
        break-inside: avoid;
      }
    }

    /* High contrast mode */
    @media (prefers-contrast: high) {
      .form-group input, 
      .form-group textarea, 
      .form-group select {
        border-width: 3px;
      }
      
      .btn {
        border: 2px solid transparent;
      }
      
      .btn:focus {
        outline: 3px solid;
      }
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
  </style>
</body>
</html>
